{
  "id": "snapshot_1760240430642_gxpqw2t71",
  "approvalId": "approval_1760240430570_7wd5zywm3",
  "approvalTitle": "Core Version Management - Tasks Document",
  "version": 1,
  "timestamp": "2025-10-12T03:40:30.642Z",
  "trigger": "initial",
  "status": "pending",
  "content": "# Tasks Document\n\n## Implementation Tasks for core-version-management Spec\n\n- [ ] 1. Create Maven version structures in pkg/maven\n  - Files: `pkg/maven/version.go`\n  - Define Version struct (Major, Minor, Patch, Qualifier)\n  - Implement ParseVersion() function\n  - Implement Version.Compare() method for semantic versioning\n  - Purpose: Provide public version parsing and comparison utilities\n  - _Leverage: Go standard library (strings, strconv)_\n  - _Requirements: Req 9 (Get Latest Version - comparison logic)_\n  - _Prompt: Implement the task for spec core-version-management, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Go Developer with expertise in semantic versioning and data structures | Task: Create pkg/maven/version.go implementing Version struct and semantic version parsing/comparison following design.md Component 5, supporting Maven version formats (X.Y.Z and X.Y.Z-qualifier) | Restrictions: Must handle qualifiers (alpha, beta, RC), use semantic versioning rules, export all types and functions, no external dependencies beyond stdlib | Success: ParseVersion(\"3.9.4\") works, Compare() correctly orders versions, qualifiers handled properly, unit tests pass | Instructions: After completing, edit tasks.md and change this task from [ ] to [x]_\n\n- [ ] 2. Create Maven path utilities in pkg/maven\n  - Files: `pkg/maven/paths.go`\n  - Implement GetMavenBinaryPath() for bin/mvn.cmd location\n  - Implement GetMavenHome() for Maven installation root\n  - Implement ValidateMavenInstallation() to verify valid Maven directory\n  - Purpose: Provide Maven-specific path resolution utilities\n  - _Leverage: filepath package for Windows paths_\n  - _Requirements: Req 1 (Installation verification), Req 3 (List installed)_\n  - _Prompt: Implement the task for spec core-version-management, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Go Developer with expertise in file path handling and Windows conventions | Task: Create pkg/maven/paths.go with Maven installation path utilities following design.md, using Windows-style paths and validating Maven directory structure | Restrictions: Must use filepath package, handle Windows backslashes, check for bin/mvn.cmd existence, export all functions | Success: GetMavenBinaryPath() returns correct Windows path, ValidateMavenInstallation() detects valid/invalid installations, paths use backslashes | Instructions: After completing, edit tasks.md and change this task from [ ] to [x]_\n\n- [ ] 3. Create download manager in internal/download\n  - Files: `internal/download/downloader.go`, `internal/download/checksum.go`\n  - Implement Downloader interface with HTTP download and progress tracking\n  - Implement ChecksumVerifier for SHA-256 verification\n  - Add retry logic and timeout handling\n  - Purpose: Provide reliable download with integrity verification (shared with nexus spec)\n  - _Leverage: net/http, crypto/sha256, io packages_\n  - _Requirements: Req 1 (Install with checksum verification)_\n  - _Prompt: Implement the task for spec core-version-management, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Go Developer specializing in HTTP operations and file integrity | Task: Create internal/download package with Downloader and ChecksumVerifier following design.md, supporting HTTP downloads with SHA-256 verification, progress tracking, retries, and timeouts | Restrictions: Must verify all downloads with SHA-256, handle network errors gracefully, provide progress callbacks, no external HTTP libraries (use stdlib) | Success: Downloads work with progress, checksums verified correctly, failed downloads cleaned up, retries on transient errors | Instructions: After completing, edit tasks.md and change this task from [ ] to [x]_\n\n- [ ] 4. Create config package additions\n  - Files: `internal/config/config.go`, `internal/config/paths.go`\n  - Add GlobalVersion field to Config struct\n  - Implement GetGlobalVersion() and SetGlobalVersion() methods\n  - Add path helpers: VersionsDir(), CacheDir(), ConfigDir()\n  - Purpose: Extend config package for version management needs\n  - _Leverage: Existing config package from steering docs, gopkg.in/yaml.v3_\n  - _Requirements: Req 6 (Set Global Version)_\n  - _Prompt: Implement the task for spec core-version-management, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Go Developer with expertise in configuration management and YAML | Task: Extend internal/config package with global version support and path helpers following design.md, adding GlobalVersion field and path resolution methods | Restrictions: Must preserve existing config fields, use YAML for persistence, handle missing config file gracefully, use %USERPROFILE%/.mvnenv paths | Success: Global version can be get/set, config persists to YAML, path helpers return correct Windows paths, config loading doesn't break existing code | Instructions: After completing, edit tasks.md and change this task from [ ] to [x]_\n\n- [ ] 5. Create VersionResolver for version resolution\n  - Files: `internal/version/resolver.go`\n  - Implement VersionResolver struct with ResolveVersion() method\n  - Implement shell > local > global hierarchy\n  - Add GetShellVersion(), GetLocalVersion(), GetGlobalVersion() methods\n  - Add IsVersionInstalled() verification\n  - Purpose: Determine which Maven version should be active\n  - _Leverage: internal/config, os package for environment variables, filepath for .maven-version search_\n  - _Requirements: Req 5 (Version Resolution)_\n  - _Prompt: Implement the task for spec core-version-management, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Go Developer specializing in file system operations and environment variables | Task: Create internal/version/resolver.go implementing VersionResolver following design.md Component 2, with shell > local > global hierarchy, searching parent directories for .maven-version files | Restrictions: Must follow exact hierarchy (shell first, then local, then global), search up directory tree for .maven-version, verify version is installed before returning, handle missing config gracefully | Success: ResolveVersion() returns correct version based on hierarchy, shell env takes precedence, .maven-version found in parents, global from config works, uninstalled versions return error | Instructions: Before starting, edit tasks.md and change this task from [ ] to [-]. After completing, change from [-] to [x]_\n\n- [ ] 6. Create VersionInstaller for install/uninstall\n  - Files: `internal/version/installer.go`\n  - Implement VersionInstaller struct with Install() and Uninstall() methods\n  - Add atomic installation with temp directory and rollback\n  - Implement VerifyInstallation() for post-install checks\n  - Add IsInstalled() check\n  - Purpose: Handle Maven version lifecycle (install/uninstall)\n  - _Leverage: internal/download, pkg/maven paths, archive/zip for extraction_\n  - _Requirements: Req 1 (Install), Req 2 (Uninstall)_\n  - _Prompt: Implement the task for spec core-version-management, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Go Developer with expertise in file operations and atomic transactions | Task: Create internal/version/installer.go implementing VersionInstaller following design.md Component 3 and installation flow diagram, with atomic install (extract to temp, verify, move), checksum verification, and complete rollback on failure | Restrictions: Must be atomic (all-or-nothing), use temp directory during install, rollback completely on any error, verify Maven binary exists after extraction, handle Windows file locking | Success: Installation atomic with rollback, checksums verified, temp files cleaned up on failure, uninstall removes directory cleanly, already-installed detected | Instructions: Before starting, edit tasks.md and change this task from [ ] to [-]. After completing, change from [-] to [x]_\n\n- [ ] 7. Create VersionLister for listing versions\n  - Files: `internal/version/lister.go`\n  - Implement VersionLister struct with ListInstalled() and ListAvailable() methods\n  - Add GetLatest() for finding latest version with optional prefix\n  - Implement version sorting using pkg/maven comparison\n  - Purpose: List installed and available Maven versions\n  - _Leverage: pkg/maven version comparison, internal/version/cache_\n  - _Requirements: Req 3 (List Installed), Req 4 (List Available), Req 9 (Get Latest)_\n  - _Prompt: Implement the task for spec core-version-management, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Go Developer specializing in directory scanning and sorting algorithms | Task: Create internal/version/lister.go implementing VersionLister following design.md Component 4, scanning versions directory for installed versions, sorting by semantic version, finding latest with prefix support | Restrictions: Must validate each version directory (check for Maven binary), sort descending (newest first), handle empty versions directory, filter by prefix for GetLatest | Success: ListInstalled() scans directory correctly, versions sorted newest first, invalid directories skipped, GetLatest(\"3.8\") returns newest 3.8.x version | Instructions: Before starting, edit tasks.md and change this task from [ ] to [-]. After completing, change from [-] to [x]_\n\n- [ ] 8. Create VersionCache for caching available versions\n  - Files: `internal/version/cache.go`\n  - Implement VersionCache struct with Get() and Set() methods\n  - Add timestamp-based TTL (24 hours default)\n  - Store cache in JSON format\n  - Purpose: Cache available versions to avoid repeated repository queries\n  - _Leverage: encoding/json, time package_\n  - _Requirements: Req 4 (List Available with caching), Req 10 (Update Cache)_\n  - _Prompt: Implement the task for spec core-version-management, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Go Developer with expertise in caching and time-based expiration | Task: Create internal/version/cache.go implementing VersionCache following design.md data models, storing available versions with timestamp in JSON, checking TTL (24h default) before returning cached data | Restrictions: Must use JSON format, include timestamp in cache file, check staleness before returning, create cache directory if missing, handle corrupt cache gracefully | Success: Cache stores and retrieves versions, TTL respected (stale cache returns nil), JSON format valid, cache file in correct location | Instructions: Before starting, edit tasks.md and change this task from [ ] to [-]. After completing, change from [-] to [x]_\n\n- [ ] 9. Create VersionManager orchestrator\n  - Files: `internal/version/manager.go`\n  - Implement VersionManager struct composing Resolver, Installer, and Lister\n  - Add high-level methods: Install(), Uninstall(), GetCurrentVersion(), SetGlobalVersion(), SetLocalVersion(), etc.\n  - Purpose: Provide unified API for all version management operations\n  - _Leverage: All internal/version components (resolver, installer, lister, cache)_\n  - _Requirements: All requirements (orchestration layer)_\n  - _Prompt: Implement the task for spec core-version-management, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Software Architect specializing in API design and component orchestration | Task: Create internal/version/manager.go implementing VersionManager following design.md Component 1, composing Resolver, Installer, Lister, and Cache into unified API for CLI commands | Restrictions: Must delegate to specialized components (don't duplicate logic), provide clean public API, handle errors from components gracefully, initialize all components in NewVersionManager | Success: VersionManager provides all required methods, delegates correctly to components, CLI commands can use simple API, error handling consistent | Instructions: Before starting, edit tasks.md and change this task from [ ] to [-]. After completing, change from [-] to [x]_\n\n- [ ] 10. Integrate VersionManager with CLI commands\n  - Files: `cmd/mvnenv/version.go`, `cmd/mvnenv/versions.go`, `cmd/mvnenv/global.go`, `cmd/mvnenv/local.go`, `cmd/mvnenv/shell.go`, `cmd/mvnenv/install.go`, `cmd/mvnenv/uninstall.go`, `cmd/mvnenv/latest.go`, `cmd/mvnenv/update.go`\n  - Replace placeholder logic in CLI commands with VersionManager calls\n  - Initialize VersionManager in main.go for command access\n  - Handle errors and display user-friendly messages\n  - Purpose: Connect version management business logic to CLI\n  - _Leverage: cli-commands spec implementation, internal/version/manager_\n  - _Requirements: All requirements (integration)_\n  - _Prompt: Implement the task for spec core-version-management, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Go Developer with expertise in CLI integration and error handling | Task: Integrate VersionManager with CLI commands from cli-commands spec, replacing placeholder logic with real VersionManager method calls, handling errors and formatting output following pyenv-win conventions | Restrictions: Must maintain CLI command signatures, use consistent error handling, output plain text (no colors/emojis), silent on success for setters, format errors with \"Error: \" prefix | Success: All CLI commands work with real version management, install/uninstall functional, version resolution works, errors displayed clearly, follows pyenv-win output style | Instructions: Before starting, edit tasks.md and change this task from [ ] to [-]. After completing, change from [-] to [x]_\n\n- [ ] 11. Add unit tests for pkg/maven/version.go\n  - Files: `pkg/maven/version_test.go`\n  - Test ParseVersion() with various formats (3.9.4, 3.9.0-beta-1, etc.)\n  - Test Version.Compare() with all comparison cases\n  - Test semantic versioning edge cases (qualifiers, leading zeros)\n  - Purpose: Ensure version parsing and comparison correctness\n  - _Leverage: Go testing package, table-driven tests_\n  - _Requirements: Req 9 (version comparison for GetLatest)_\n  - _Prompt: Implement the task for spec core-version-management, first run spec-workflow-guide to get the workflow guide then implement the task: Role: QA Engineer with expertise in unit testing and edge case coverage | Task: Create comprehensive unit tests for pkg/maven/version.go testing ParseVersion and Compare methods with table-driven tests covering standard versions, qualifiers, and edge cases | Restrictions: Must use table-driven tests, test all version formats (X.Y.Z and X.Y.Z-qualifier), verify correct semantic ordering, test error cases (invalid formats), achieve 100% coverage | Success: All version parsing tested, comparison correctness verified, qualifiers handled properly, invalid formats return errors, 100% coverage | Instructions: Before starting, edit tasks.md and change this task from [ ] to [-]. After completing, change from [-] to [x]_\n\n- [ ] 12. Add unit tests for VersionResolver\n  - Files: `internal/version/resolver_test.go`\n  - Test shell > local > global hierarchy\n  - Test .maven-version file discovery in parent directories\n  - Test version installed verification\n  - Mock FileSystem and ConfigProvider\n  - Purpose: Ensure version resolution logic correctness\n  - _Leverage: Go testing, testify/mock for mocking_\n  - _Requirements: Req 5 (Version Resolution)_\n  - _Prompt: Implement the task for spec core-version-management, first run spec-workflow-guide to get the workflow guide then implement the task: Role: QA Engineer specializing in behavior testing and mocking | Task: Create unit tests for VersionResolver testing resolution hierarchy (shell > local > global), .maven-version discovery in parent dirs, and version verification using mocked filesystem and config | Restrictions: Must mock filesystem and config, test each hierarchy level independently, verify parent directory traversal for .maven-version, test version not installed error, >90% coverage | Success: Hierarchy precedence tested (shell wins), .maven-version found in parents, global from config works, uninstalled versions error, >90% coverage | Instructions: Before starting, edit tasks.md and change this task from [ ] to [-]. After completing, change from [-] to [x]_\n\n- [ ] 13. Add unit tests for VersionInstaller\n  - Files: `internal/version/installer_test.go`\n  - Test successful installation flow\n  - Test rollback on checksum failure\n  - Test rollback on extraction failure\n  - Test already-installed detection\n  - Mock Downloader and filesystem\n  - Purpose: Ensure installation atomicity and error handling\n  - _Leverage: Go testing, mock filesystem for temp directory tests_\n  - _Requirements: Req 1 (Install), Req 2 (Uninstall)_\n  - _Prompt: Implement the task for spec core-version-management, first run spec-workflow-guide to get the workflow guide then implement the task: Role: QA Engineer with expertise in testing atomic operations and rollback scenarios | Task: Create unit tests for VersionInstaller testing installation success, checksum failure rollback, extraction failure rollback, and already-installed detection using mocked downloader and filesystem | Restrictions: Must test rollback scenarios (checksum fail, extraction fail), verify temp directory cleanup, test already-installed early exit, mock all external dependencies, >90% coverage | Success: Installation flow tested end-to-end, rollbacks verified (no partial installs), already-installed detected, temp files cleaned up, >90% coverage | Instructions: Before starting, edit tasks.md and change this task from [ ] to [-]. After completing, change from [-] to [x]_\n\n- [ ] 14. Add unit tests for VersionLister\n  - Files: `internal/version/lister_test.go`\n  - Test ListInstalled() with version sorting\n  - Test GetLatest() with and without prefix\n  - Test empty versions directory handling\n  - Test invalid version directory exclusion\n  - Purpose: Ensure listing and latest version logic correctness\n  - _Leverage: Go testing, mock filesystem_\n  - _Requirements: Req 3 (List Installed), Req 9 (Get Latest)_\n  - _Prompt: Implement the task for spec core-version-management, first run spec-workflow-guide to get the workflow guide then implement the task: Role: QA Engineer specializing in sorting algorithms and filtering logic | Task: Create unit tests for VersionLister testing ListInstalled sorting (newest first), GetLatest with prefix filtering, empty directory handling, and invalid version exclusion using mocked filesystem | Restrictions: Must verify descending sort order (newest first), test prefix matching for GetLatest, verify invalid directories skipped, test empty directory returns empty list, >90% coverage | Success: Sorting verified (3.9.4 before 3.8.6), GetLatest(\"3.8\") returns newest 3.8.x, invalid dirs excluded, empty dir handled, >90% coverage | Instructions: Before starting, edit tasks.md and change this task from [ ] to [-]. After completing, change from [-] to [x]_\n\n- [ ] 15. Add unit tests for VersionCache\n  - Files: `internal/version/cache_test.go`\n  - Test cache Get() with fresh and stale data\n  - Test cache Set() with timestamp\n  - Test corrupt cache handling\n  - Test missing cache directory creation\n  - Purpose: Ensure cache reliability and TTL correctness\n  - _Leverage: Go testing, time mocking_\n  - _Requirements: Req 4 (caching), Req 10 (Update Cache)_\n  - _Prompt: Implement the task for spec core-version-management, first run spec-workflow-guide to get the workflow guide then implement the task: Role: QA Engineer with expertise in caching logic and time-based testing | Task: Create unit tests for VersionCache testing cache Get/Set with TTL checking (24h), stale cache handling, corrupt cache recovery, and directory creation using temp directories and time manipulation | Restrictions: Must test fresh cache returns data, stale cache returns nil, corrupt JSON handled gracefully, missing directory created automatically, 100% coverage | Success: Fresh cache retrieved correctly, stale (>24h) returns nil, corrupt cache doesn't crash, directory auto-created, 100% coverage | Instructions: Before starting, edit tasks.md and change this task from [ ] to [-]. After completing, change from [-] to [x]_\n\n- [ ] 16. Add unit tests for VersionManager\n  - Files: `internal/version/manager_test.go`\n  - Test all VersionManager public methods\n  - Test component orchestration\n  - Test error propagation from components\n  - Mock all dependencies (Resolver, Installer, Lister)\n  - Purpose: Ensure VersionManager orchestration correctness\n  - _Leverage: Go testing, mocks for components_\n  - _Requirements: All requirements (orchestration testing)_\n  - _Prompt: Implement the task for spec core-version-management, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Integration Tester specializing in component orchestration and API testing | Task: Create unit tests for VersionManager testing all public methods (Install, Uninstall, GetCurrentVersion, SetGlobal/Local, etc.) with mocked components verifying correct delegation and error handling | Restrictions: Must mock Resolver, Installer, Lister, Cache; verify method calls to components; test error propagation; test all public API methods; >90% coverage | Success: All VersionManager methods tested, delegation to components verified, errors propagated correctly, API contract validated, >90% coverage | Instructions: Before starting, edit tasks.md and change this task from [ ] to [-]. After completing, change from [-] to [x]_\n\n- [ ] 17. Add integration tests for version resolution\n  - Files: `internal/version/integration_test.go`\n  - Test resolution with real filesystem (temp directories)\n  - Test .maven-version in nested project directories\n  - Test environment variable override\n  - Test global config persistence\n  - Purpose: Validate resolution in realistic scenarios\n  - _Leverage: Go testing, temp directories_\n  - _Requirements: Req 5 (Version Resolution), Req 6-8 (Set versions)_\n  - _Prompt: Implement the task for spec core-version-management, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Integration Engineer with expertise in filesystem testing and environment setup | Task: Create integration tests for version resolution using real temp filesystem, testing shell env override, .maven-version in nested dirs, and global config with actual file operations | Restrictions: Must use real filesystem (temp dirs), test complete resolution flow, set environment variables for shell test, create nested directories for .maven-version test, cleanup temp files | Success: Integration tests pass with real files, shell env override works, .maven-version found in parents, global config persists, tests isolated and repeatable | Instructions: Before starting, edit tasks.md and change this task from [ ] to [-]. After completing, change from [-] to [x]_\n\n- [ ] 18. Add integration tests for installation\n  - Files: `internal/version/install_integration_test.go`\n  - Test full installation flow with mock download\n  - Test uninstallation cleanup\n  - Test atomic installation rollback scenarios\n  - Use real filesystem with temp directories\n  - Purpose: Validate installation/uninstallation in realistic scenarios\n  - _Leverage: Go testing, temp directories, mock HTTP server for downloads_\n  - _Requirements: Req 1 (Install), Req 2 (Uninstall)_\n  - _Prompt: Implement the task for spec core-version-management, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Integration Engineer specializing in file operations and atomic transaction testing | Task: Create integration tests for installation using real temp filesystem and mock HTTP server, testing complete install/uninstall flow, atomic operations, and rollback scenarios | Restrictions: Must use real filesystem (temp dirs), mock HTTP server for downloads, test atomicity (rollback on failure), verify no partial installs, cleanup all temp files | Success: Integration tests pass with real files, installation atomic, rollback works correctly, uninstall cleans up completely, no file leaks | Instructions: Before starting, edit tasks.md and change this task from [ ] to [-]. After completing, change from [-] to [x]_\n\n- [ ] 19. Add performance benchmarks\n  - Files: `internal/version/benchmark_test.go`\n  - Benchmark ResolveVersion() targeting <100ms\n  - Benchmark ListInstalled() targeting <100ms\n  - Benchmark version comparison operations\n  - Purpose: Ensure performance requirements are met\n  - _Leverage: Go benchmark testing_\n  - _Requirements: Performance non-functional requirements_\n  - _Prompt: Implement the task for spec core-version-management, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Performance Engineer with expertise in Go benchmarking and optimization | Task: Create performance benchmarks for VersionResolver.ResolveVersion() and VersionLister.ListInstalled() verifying <100ms targets, and version comparison <1ms | Restrictions: Must benchmark critical path operations only, measure realistic scenarios (with files present), document results, identify optimization opportunities if targets not met | Success: Benchmarks run successfully, ResolveVersion <100ms, ListInstalled <100ms, comparison <1ms, or gaps documented with optimization plan | Instructions: Before starting, edit tasks.md and change this task from [ ] to [-]. After completing, change from [-] to [x]_\n\n- [ ] 20. Create end-to-end test scenarios\n  - Files: `test/e2e/version_management_test.go`\n  - Test complete user workflows (install -> set global -> use)\n  - Test project-specific version (local) workflow\n  - Test version switching scenarios\n  - Use real mvnenv binary with temp environment\n  - Purpose: Validate complete version management workflows\n  - _Leverage: Go testing, exec package to run mvnenv CLI_\n  - _Requirements: All requirements (E2E validation)_\n  - _Prompt: Implement the task for spec core-version-management, first run spec-workflow-guide to get the workflow guide then implement the task: Role: QA Automation Engineer specializing in end-to-end testing and user workflow validation | Task: Create E2E tests running complete version management workflows (install version, set global, verify active, switch to local, verify switch) using built mvnenv binary and temp environment | Restrictions: Must test realistic user scenarios, use actual CLI binary, temp isolated environment (%USERPROFILE% override), verify version switching works end-to-end, cleanup after tests | Success: E2E tests pass with real binary, install workflow works, global/local version setting verified, version switching tested, user experience validated | Instructions: Before starting, edit tasks.md and change this task from [ ] to [-]. After completing, change from [-] to [x]_\n\n- [ ] 21. Create error handling documentation\n  - Files: `internal/version/errors.go`\n  - Define all error types (ErrVersionNotInstalled, ErrAlreadyInstalled, etc.)\n  - Add error wrapping helpers for context\n  - Document error messages and user actions\n  - Purpose: Provide consistent error handling across version management\n  - _Leverage: errors package, fmt.Errorf with %w_\n  - _Requirements: Req 8 (Error Handling NFR)_\n  - _Prompt: Implement the task for spec core-version-management, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Go Developer with expertise in error handling patterns and user experience | Task: Create internal/version/errors.go defining all error types from design.md error handling section, providing exported error variables and helper functions for wrapping errors with context | Restrictions: Must define exported error variables for all scenarios, use errors.New for base errors, provide helpers for wrapping with context (fmt.Errorf with %w), document each error with suggested user action | Success: All error types defined, error variables exported, wrapping helpers provided, error messages clear and actionable, documentation complete | Instructions: Before starting, edit tasks.md and change this task from [ ] to [-]. After completing, change from [-] to [x]_\n\n- [ ] 22. Final integration and code review\n  - Files: All files in `internal/version/`, `pkg/maven/`\n  - Review all component implementations for consistency\n  - Verify error handling follows patterns\n  - Ensure performance benchmarks meet targets\n  - Verify >90% test coverage across all packages\n  - Check CLI integration works end-to-end\n  - Purpose: Ensure specification is fully implemented and ready\n  - _Leverage: All previous tasks, requirements.md Success Criteria_\n  - _Requirements: All requirements_\n  - _Prompt: Implement the task for spec core-version-management, first run spec-workflow-guide to get the workflow guide then implement the task: Role: Senior Go Developer and Code Reviewer with expertise in version management and code quality | Task: Perform final integration review of core version management implementation, verifying all Success Criteria from requirements.md are met, test coverage >90%, performance targets met, error handling consistent, CLI integration complete | Restrictions: Must verify all Success Criteria from requirements.md, ensure atomic installations work, test resolution hierarchy, confirm performance targets (<100ms), validate >90% coverage | Success: All Success Criteria from requirements.md verified and met, atomic installations confirmed, resolution works correctly, performance targets met, >90% coverage, CLI integration functional, ready for production use | Instructions: Before starting, edit tasks.md and change this task from [ ] to [-]. After completing, change from [-] to [x]_\n\n## Task Execution Notes\n\n### Sequential Dependencies\n\n**Foundation (Tasks 1-4):**\n- Task 1 (pkg/maven/version.go) must complete first (used by many components)\n- Task 2 (pkg/maven/paths.go) must complete first (used by installer, lister)\n- Task 3 (internal/download) must complete first (used by installer)\n- Task 4 (internal/config) must complete first (used by resolver, manager)\n\n**Core Components (Tasks 5-9):**\n- Tasks 1-4 must complete before starting tasks 5-9\n- Task 5 (VersionResolver) can start after task 4\n- Task 6 (VersionInstaller) can start after tasks 2-3\n- Task 7 (VersionLister) can start after tasks 1-2\n- Task 8 (VersionCache) can start after task 4\n- Task 9 (VersionManager) must wait for tasks 5-8 to complete\n\n**Integration (Task 10):**\n- Task 10 requires task 9 and all cli-commands spec tasks to be complete\n\n**Testing (Tasks 11-20):**\n- Unit tests (11-16) can start after corresponding component completes\n- Integration tests (17-18) require components they test\n- Benchmarks (19) can start after components complete\n- E2E tests (20) require task 10 (CLI integration) to be complete\n\n**Finalization (Tasks 21-22):**\n- Task 21 (errors) can be done anytime (preferably early)\n- Task 22 must be last (final review)\n\n### Parallel Execution Opportunities\n\n**Group 1: Foundation (Tasks 1-4):**\n- Tasks 1 and 2 can be done in parallel (both in pkg/maven)\n- Task 3 (download) can be done in parallel with 1-2\n- Task 4 (config) can be done in parallel with 1-3\n\n**Group 2: Core Components (Tasks 5-8):**\n- After tasks 1-4 complete, tasks 5-8 can be done in parallel\n- Each component is independent\n\n**Group 3: Unit Tests (Tasks 11-16):**\n- Can be done in parallel after corresponding components complete\n- Each test file is independent\n\n**Group 4: Integration Tests (Tasks 17-19):**\n- Can be done in parallel after components they test are complete\n\n### Integration with Other Specs\n\n**cli-commands spec:**\n- Task 10 integrates with cli-commands implementations\n- CLI command placeholders replaced with VersionManager calls\n\n**nexus-repository-integration spec:**\n- VersionLister.ListAvailable() will use Nexus repository provider\n- Installer.getDownloadURL() will query Nexus for URLs\n\n**shim-system-implementation spec:**\n- Shim will call VersionResolver.ResolveVersion() to determine which Maven to execute\n\n### Performance Targets\n\n**Version Resolution (<100ms):**\n- Optimize file system checks (cache directory scans)\n- Use efficient .maven-version search (stop at first match)\n\n**List Installed (<100ms):**\n- Single directory scan with validation\n- Sort in memory (not slow for typical version count)\n\n**Installation:**\n- Network-bound, 30-60s acceptable\n- Focus on reliability over speed (atomic operations)\n",
  "fileStats": {
    "size": 32569,
    "lines": 312,
    "lastModified": "2025-10-12T03:38:50.917Z"
  },
  "comments": []
}